no---
title: "Project 1"
author: "Fadumo Hussein"
date: "2023-02-09"
output: html_document
---

## Loading packages 

```{r}
#N Install
install.packages("tm")  # for text mining
install.packages("SnowballC") # for text stemming
install.packages("wordcloud") # word-cloud generator 
install.packages("RColorBrewer") # color palettes
install.packages("syuzhet") # for sentiment analysis
install.packages("ggplot2") # for plotting graphs
# Load
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("syuzhet")
library("ggplot2")
library("readr")
library("tidyverse")
library("mice")
```

## Upload data 
```{r}
poetry_review <- read_csv("poetry_review.csv")
head(poetry_review)

book_titles <- read_csv("book_titles.csv")
head(book_titles)
```
## Data Preparation 
```{r}
#Bind the data
reviews <- merge(poetry_review, book_titles, by="book_id")
View(reviews)
str(reviews)


#Combine columns that are helpful 
reviews_2 <- subset(reviews, select = c("title", "average_rating", "publisher", "rating", "review_text", "format", "ratings_count", "text_reviews_count", "num_pages") )
view(reviews_2)

#Remove NAs from the dataset 
str(reviews_2)
md.pattern(reviews_2, rotate.names = TRUE)
reviews_3 <- reviews_2[complete.cases(reviews_2), ]
md.pattern(reviews_3, rotate.names = TRUE)
View(reviews_3)

```

## Cleaning up Text Data
```{r}
# Remove common words, puncutation, white, space,  

review_corpus = VCorpus(VectorSource(reviews_3$review_text))
review_corpus = tm_map(review_corpus, content_transformer(tolower))
review_corpus = tm_map(review_corpus, removeNumbers)
review_corpus = tm_map(review_corpus, removePunctuation)
review_corpus = tm_map(review_corpus, removeWords, c("the", "and", stopwords("english")))
review_corpus =  tm_map(review_corpus, stripWhitespace)
review_corpus <- tm_map(review_corpus, stemDocument)
inspect(review_corpus[2])


review_dtm <- DocumentTermMatrix(review_corpus)
review_dtm

inspect(review_dtm[500:505, 500:505])

review_dtm = removeSparseTerms(review_dtm, 0.99)
review_dtm

inspect(review_dtm[2,1:20])

findFreqTerms(review_dtm, 1000)

freq = data.frame(sort(colSums(as.matrix(review_dtm)), decreasing=TRUE))
wordcloud(rownames(freq), freq[,1], max.words=100, colors=brewer.pal(1, "Dark2"))
```

