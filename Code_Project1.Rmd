no---
title: "Project 1"
author: "Fadumo Hussein"
date: "2023-02-09"
output: html_document
---

## Loading packages 

```{r}
#N Install
install.packages("tm")  # for text mining
install.packages("SnowballC") # for text stemming
install.packages("wordcloud") # word-cloud generator 
install.packages("RColorBrewer") # color palettes
install.packages("syuzhet") # for sentiment analysis
install.packages("ggplot2") # for plotting graphs
# Load
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("syuzhet")
library("ggplot2")
library("readr")
library("tidyverse")
library("mice")
```

## Upload data 
```{r}
poetry_review <- read_csv("poetry_review.csv")
head(poetry_review)

book_titles <- read_csv("book_titles.csv")
head(book_titles)
```
## Data Preparation 
```{r}

#Remove columns 
reviews <- book_spoilers[ c("review_sentences", "rating", "has_spoiler") ]
head(reviews)

#Remove NAs from the dataset 
str(reviews)
md.pattern(reviews, rotate.names = TRUE)
reviews_2 <- reviews[complete.cases(reviews), ]
md.pattern(reviews_2, rotate.names = TRUE)
View(reviews_2)

#Factor 
reviews_2$has_spoilers  <- fct_collapse(reviews_2$has_spoilers,
                           Yes = "Yes", 
                           No ="No",
                        other = c("Other"))

```

```

## Cleaning up Text Data
```{r}
# Remove common words, puncutation, white, space,  

review_corpus = VCorpus(VectorSource(reviews_2$review_text))
review_corpus = tm_map(review_corpus, content_transformer(tolower))
review_corpus = tm_map(review_corpus, removeNumbers)
review_corpus = tm_map(review_corpus, removePunctuation)
review_corpus = tm_map(review_corpus, removeWords, c("the", "and", stopwords("english")))
review_corpus =  tm_map(review_corpus, stripWhitespace)
review_corpus <- tm_map(review_corpus, stemDocument)
inspect(review_corpus[2])


review_dtm <- DocumentTermMatrix(review_corpus)
review_dtm

inspect(review_dtm[500:505, 500:505])

review_dtm = removeSparseTerms(review_dtm, 0.99)
review_dtm

inspect(review_dtm[2,1:20])

findFreqTerms(review_dtm, 1000)

freq = data.frame(sort(colSums(as.matrix(review_dtm)), decreasing=TRUE))
wordcloud(rownames(freq), freq[,1], max.words=100, colors=brewer.pal(1, "Dark2"))
```

